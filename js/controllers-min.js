function MainCtrl(o,e){if(null===localStorage.getItem("usuario"))e.logeo=!1,o.go("index.logeo"),$("#page-wrapper").css("margin-left","0px");else{var r=$.parseJSON(localStorage.getItem("usuario"));$("#page-wrapper").css("margin-left",""),e.logeo=!0,e.nombreUsuario=r.Nombre,console.log("$scope.nombreUsuario",e.nombreUsuario),e.apellidoUsuario=r.Apellido,e.empresa=r.empresa}e.$on("revisar-logeo",function(r){if(null===localStorage.getItem("usuario"))e.logeo=!1,$("#page-wrapper").css("margin-left","0px"),o.go("index.logeo");else{var a=$.parseJSON(localStorage.getItem("usuario"));$("#page-wrapper").css("margin-left",""),e.logeo=!0,e.nombreUsuario=a.Nombre,console.log("$scope.nombreUsuario",e.nombreUsuario),e.apellidoUsuario=a.Apellido,e.empresa=a.empresa}})}function principalCtrl(o,e,r,a,s,c){console.log("Controlador:",this),a.$broadcast("revisar-logeo");var t=c.defer();s({url:"backend/trearProyectos.php",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Login-Ajax-call":"true"},timeout:t.promise,cancel:t}).success(function(e){if(1==e.success){o.proyectos=e.root;for(var r=0;r<o.proyectos.length;r++)o.proyectos[r].datos=JSON.parse(o.proyectos[r].datos);console.log("$scope.proyectos",o.proyectos)}})}function logeoCtrl(o,e,r,a,s){console.log("Controlador:",this),r.$broadcast("revisar-logeo"),null!==localStorage.getItem("usuario")&&e.go("index.principal"),o.usuario={},o.error=!1,o.logeo=function(){o.error=!1;var c=s.defer();a({url:"backend/usuarios.php",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Login-Ajax-call":"true"},timeout:c.promise,cancel:c,data:"action=logeo&usuario="+JSON.stringify(o.usuario)}).success(function(a){1==a.success?(localStorage.setItem("usuario",JSON.stringify(a.root[0])),r.$broadcast("revisar-logeo"),e.go("index.principal"),console.log(a.root[0])):(o.error=!0,o.errorTexto=a.messageText)})}}function nuevoProyectoCtrl(o,e,r,a,s){console.log("Controlador:",this),r.$broadcast("revisar-logeo"),o.proyecto={},o.validate=!0,o.proyecto.presupuesto=0,o.proyecto.duracion=0,o.languages=[{name:"Access",value:38},{name:"APL",value:32},{name:"BASIC",value:150},{name:"C",value:128},{name:"C++",value:55},{name:"COBOL",value:91},{name:"Fortran",value:77},{name:"High Level Language",value:64},{name:"HTML",value:15},{name:"Java",value:53}],o.proyecto.gscAsks=[{pregunta:"Cuantas facilidades existen para ayudar la comunicacion, transferencia o intercambio de informacion con el sistema?",valor:1},{pregunta:"Como se maneja la distribucion y procesamiento de informacion?",valor:1},{pregunta:"Se requiere tener un buen tiempo de respuesta al usuario?",valor:1},{pregunta:"Que tanto es usado el hardware donde el sistema sera ejecutado?",valor:1},{pregunta:"Que tan frecuente las transacciones son ejecutadas? (diario, semanal, mensual , etc)",valor:1},{pregunta:"Que porcentaje de la informacion es inyectada en linea?",valor:1},{pregunta:"El sistema esta desarrollado para ser eficiente a nivel usuario final?",valor:1},{pregunta:"Cuanta informacion es actualizada en linea?",valor:1},{pregunta:"El sistema ejecutara procesos logicos o matematicos complejos?",valor:1},{pregunta:"El sistema tendra que ser capaz de atender necesidades diferentes por usuario?",valor:1},{pregunta:"Cual es la dificultad de instalacion?",valor:1},{pregunta:"Que tan efectivos deber ser los procesos de recuperacion y respaldo de datos?",valor:1},{pregunta:"El sistema sera instalado o utilizado en diferentes sitios o por diferentes organizaciones?",valor:1},{pregunta:"El sistema debe ser flexible y adaptable a cambios?",valor:1}],o.proyecto.usuario=JSON.parse(localStorage.getItem("usuario")),o.sistemaLogeo=function(e){o.proyecto.LogIn=e,0==e?($("#logeo").css("box-shadow","5px 5px 5px 5px rgb(204, 104, 127)"),o.proyecto.camposLogIn=0,o.proyecto.showCamposLogIn=0):($("#logeo").css("box-shadow","5px 5px 5px 5px #49b7b2c9"),o.proyecto.camposLogIn=1,o.proyecto.showCamposLogIn=1)},o.formualarios=function(e){o.proyecto.formularios=e,0==e?($("#formularios").css("box-shadow","5px 5px 5px 5px rgb(204, 104, 127)"),o.proyecto.camposFormularios=0,o.proyecto.showCamposFormularios=0):($("#formularios").css("box-shadow","5px 5px 5px 5px #49b7b2c9"),o.proyecto.camposFormularios=1,o.proyecto.showCamposFormularios=1)},o.visualizacion=function(e){o.proyecto.visualizacion=e,0==e?($("#visualizacion").css("box-shadow","5px 5px 5px 5px rgb(204, 104, 127)"),o.proyecto.camposVisualizacion=0,o.proyecto.showCamposVisualizacion=0):($("#visualizacion").css("box-shadow","5px 5px 5px 5px #49b7b2c9"),o.proyecto.camposVisualizacion=1,o.proyecto.showCamposVisualizacion=1)},o.exportacion=function(e){o.proyecto.exportacion=e,0==e?($("#exportacion").css("box-shadow","5px 5px 5px 5px rgb(204, 104, 127)"),o.proyecto.camposExportacion=0,o.proyecto.showCamposExportacion=0):($("#exportacion").css("box-shadow","5px 5px 5px 5px #49b7b2c9"),o.proyecto.camposExportacion=1,o.proyecto.showCamposExportacion=1)},o.cohesion=function(e){o.proyecto.cohesion=e,0==e?($("#cohesion").css("box-shadow","5px 5px 5px 5px rgb(204, 104, 127)"),o.proyecto.camposCohesion=0,o.proyecto.showCamposCohesion=0):($("#cohesion").css("box-shadow","5px 5px 5px 5px #49b7b2c9"),o.proyecto.camposCohesion=1,o.proyecto.showCamposCohesion=1)},o.api=function(e){o.proyecto.api=e,0==e?($("#api").css("box-shadow","5px 5px 5px 5px rgb(204, 104, 127)"),o.proyecto.camposApi=0,o.proyecto.showCamposApi=0):($("#api").css("box-shadow","5px 5px 5px 5px #49b7b2c9"),o.proyecto.camposApi=1,o.proyecto.showCamposApi=1)},o.ei=function(o,e){if(o=Number(o),e=Number(e),null!=o&&null!=e)switch(o){case 1:switch(e){case 3:return 3;case 10:return 3;case 16:return 4}case 2:switch(e){case 3:return 3;case 10:return 4;case 16:return 6}case 3:switch(e){case 3:return 4;case 10:return 6;case 16:return 6}}return 0},o.ilf=function(o){if(null!=(o=Number(o)))switch(o){case 1:return 7;case 2:return 7;case 3:return 7;case 4:return 10;case 5:return 10;case 6:return 10;case 7:return 15;case 8:return 15;case 9:return 15}return 0},o.elf=function(o){if(null!=(o=Number(o)))switch(o){case 1:return 5;case 2:return 5;case 3:return 7;case 4:return 7;case 5:return 10}return 0},o.calcularPuntosFuncion=function(){console.log(o.proyecto),o.proyecto.puntosFuncion=3*(o.ei(1,o.proyecto.camposLogIn)+o.ei(o.proyecto.formularios,o.proyecto.camposFormularios)+o.ei(o.proyecto.visualizacion,o.proyecto.camposVisualizacion)+o.ei(o.proyecto.exportacion,o.proyecto.camposExportacion)+o.ilf(o.proyecto.camposCohesion)+o.elf(o.proyecto.camposApi)),console.log("$scope.proyecto.puntosFuncion",o.proyecto.puntosFuncion),o.validate=!1},o.calcularVAF=function(){for(var e=0,r=0;r<o.proyecto.gscAsks.length;r++)e+=Number(o.proyecto.gscAsks[r].valor);o.proyecto.gsc=e,o.proyecto.vaf=.65+o.proyecto.gsc/100,o.proyecto.fp=o.proyecto.vaf*o.proyecto.puntosFuncion},o.presupuesto=function(){o.proyecto.lenguaje&&o.proyecto.personas&&(console.log(o.proyecto),o.proyecto.duracion=o.proyecto.fp*o.proyecto.lenguaje.value/80/o.proyecto.personas,o.proyecto.presupuesto=2e4*o.proyecto.duracion*(o.proyecto.personas/2))},o.guardar=function(){var r=s.defer();a({url:"backend/guardarProyecto.php",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Login-Ajax-call":"true"},timeout:r.promise,cancel:r,data:"proyecto="+JSON.stringify(o.proyecto)}).success(function(o){1==o.success&&e.go("index.principal")})}}angular.module("inspinia").controller("MainCtrl",MainCtrl).controller("principalCtrl",principalCtrl).controller("nuevoProyectoCtrl",nuevoProyectoCtrl).controller("logeoCtrl",logeoCtrl);